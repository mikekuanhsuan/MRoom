
IT20202510301031_A類RM案件起案邏輯
5.4.1	新增每月RM批次A類案件（使用者預定的案件）
	如客戶符合以下任一條件，則將該客戶加入Ａ類
	前一個月曾被申報SAR
	前一個月曾有符合以下任一自定義情境條件（不論批次當下是否仍有效）：

1/1凌晨3點開始RM算分
但此時營業日12/31資料還沒進來 => 1/1晚上才開始處理
所以”前一個月”要怎麼定義 ?




---


好，這個我幫你**「精簡、結構化、可直接丟規格或對主管說」的版本 👌
我會把問題 → 核心原因 → 定義釐清 → 解法選項**一次收好。

⸻

一、問題簡述（一句話版）

每月 RM 批次在 1/1 凌晨 3 點執行，但交易與事件資料為 T+1，
導致 12/31 的資料尚未入庫，使「前一個月」的 A 類判斷必然漏判。

⸻

二、技術核心問題

資料時間差（Data Latency, T+1）
	•	12/31 為營業日
	•	12/31 的交易／SAR／情境資料 1/1 白天或晚上才入庫
	•	1/1 03:00 批次執行時：
	•	DB 實際資料只到 12/30
	•	任何發生在 12/31 的 SAR / 情境事件 不可見

➡️ 問題不在規則寫法，而在 批次執行時間點

⸻

三、「前一個月」的正確業務定義

前一個月 = 前一個曆月（依事件／交易日期）

	•	例如：3 月 RM 批次
→ 判斷 2/1–2/28(29) 之間是否：
	•	曾被申報 SAR
	•	曾符合任一自定義情境（不論目前是否仍有效）

業務邏輯範例
	•	客戶甲：2 月有 SAR → 3 月一定進 A 類
	•	客戶乙：2 月曾觸發情境，月底已恢復 → 3 月仍進 A 類
	•	客戶丙：2 月無 SAR、無情境 → 不進 A 類

⸻

四、為什麼「只改規則文字」沒用？

即使規則寫得再清楚：

「前一個月 = 12/1–12/31」

但 12/31 的資料尚未入庫，
系統 根本無法判斷 12/31 發生的事件。

➡️ 不調整作業時間或流程，問題一定發生

⸻

五、可行解法（實務建議）

解法一（最佳解）：調整 RM 批次時間 ⭐⭐⭐
	•	將每月 RM 批次排在：
	•	1/1 晚上（確認資料入庫後），或
	•	1/2
	•	確保「前一個月的所有營業日資料已到齊」

👉 最乾淨、風險最低

⸻

解法二：資料日期為準（必要但不充分）
	•	程式邏輯明確使用：
	•	event_date BETWEEN 前月1日 AND 前月最後一日
	•	仍需搭配資料已入庫
	•	單獨使用 無法解決 T+1 問題

👉 屬於基本正確性，不是完整解法

⸻

解法三：補跑／校正機制 ⭐⭐

適用於 無法改排程 的情境：
	1.	1/1 凌晨 3 點
	•	先用 12/1–12/30 產生暫時 A 類名單
	2.	12/31 資料入庫後（1/1 晚上或 1/2）
	•	補跑「只檢查 12/31」的批次
	•	將漏掉的客戶補進 A 類

👉 較複雜，但能補救風險

⸻

六、一句話結論（給主管／規格用）

本問題為 T+1 資料延遲導致的時間差問題，
若每月 RM 批次於月初凌晨執行，將必然漏判前月最後一個營業日事件。
需透過調整批次時間或補跑機制處理，僅修改規則定義不足以解決。

⸻

如果你需要，我也可以幫你再做一版：
	•	📄 系統規格用文字
	•	🧑‍💼 對主管/稽核說的簡報版
	•	💻 SQL / 批次邏輯 pseudo code

你跟我說用途就好。



